# DecentralMind Application Architecture

This document outlines the architectural strategy for the DecentralMind application, covering data storage, processing, and synchronization.

## 1. Overall Goal

The primary goal is to create an iOS application that allows users to capture and store personal data on their device, process that data locally using an AI model, and then securely archive the processed data on a decentralized storage network.

## 2. Core Components

The application is built upon three core pillars:

### Pillar 1: Local Storage (Core Data)

- **Technology:** Apple's **Core Data** framework.
- **Responsibility:** Manages all user data persisted on the device. This includes raw captured content and any metadata generated by the user or the application.
- **Implementation:** A `LocalStorageManager.swift` will serve as the primary interface for all Core Data operations (create, read, update, delete). The data models are defined in `DecentralMind.xcdatamodeld`.

### Pillar 2: Local AI Processing (`mlx-swift`)

- **Technology:** **`mlx-swift`** for on-device machine learning.
- **Responsibility:** Executes a local AI model (e.g., DeepSeek) to process the data stored via Core Data. This allows for private, on-device analysis without sending sensitive data to a server.
- **Implementation:** A `RealMLXManager.swift` will be responsible for loading the MLX model, preparing data for inference, and running the processing tasks.

### Pillar 3: Remote Decentralized Storage (Storacha)

- **Technology:** **Storacha** ([https://docs.storacha.network/](https://docs.storacha.network/)), a managed storage service built on IPFS and Filecoin.
- **Responsibility:** Provides long-term, cheap, and decentralized archival of the raw data *after* it has been processed locally. This approach ensures user privacy by only archiving data post-analysis.
- **Implementation:** A new `StorachaManager.swift` will be created. It will communicate with the Storacha HTTP REST API to handle authentication and data uploads. This abstracts away the complexities of direct Filecoin/IPFS integration.

## 3. Data Flow

The typical data lifecycle will be as follows:

1.  **Capture:** The user creates content within the app.
2.  **Local Storage:** The raw content is immediately saved to the on-device database using `LocalStorageManager` and Core Data.
3.  **Processing:** At an appropriate time (e.g., during device idle), the `RealMLXManager` fetches the data from Core Data and processes it with the local AI model.
4.  **Archival:** After successful processing, the `StorachaManager` is invoked to upload the raw data to the Storacha network for long-term storage.
5.  **Cleanup:** Once the data is successfully archived on Storacha, the application can, based on user settings, delete the raw data from the local Core Data store to save space, while keeping any extracted metadata.