# DecentralMind 2.0

## Vision

DecentralMind is an iOS application designed to be a secure, private, and intelligent personal knowledge base. It empowers users to capture, process, and query their digital information locally, functioning as a sophisticated on-device agent without relying on centralized cloud services for its core intelligence.

## Core Requirements

The development of this application is guided by four key principles:

1.  **Decentralized Storage:** All user data is synced to a decentralized network, ensuring data sovereignty and resilience. The current implementation uses **Storacha**, accessed via a secure WebView Bridge to handle its authentication protocol.
2.  **Local-First & Offline-Capable:** The app is built on **Core Data**, ensuring that all data is stored locally on the device first. This guarantees full functionality even when offline.
3.  **On-Device AI Processing:** To maintain absolute user privacy, all AI-powered analysis occurs directly on the user's device. This includes summarization, keyword extraction, and generating vector embeddings for semantic search.
4.  **Sophisticated Local Agents:** The architecture is explicitly designed to support advanced, local AI models such as **DeepSeek** and Apple's native frameworks. The goal is to process complex data types like emails and CSV files, allowing for sophisticated local queries against this information.

## Architecture Overview

The project follows a clean, modular architecture that separates concerns into distinct managers. This design is crucial for supporting the complex agent-based functionality required.

### Core Managers

*   `DataFlowManager.swift`: This is the central nervous system for all data-related operations. It acts as the single source of truth, managing all CRUD (Create, Read, Update, Delete) actions for the `ContentEntity` objects in Core Data. It is responsible for orchestrating the entire data processing pipeline by coordinating with the other managers.
*   `MLXManager.swift`: This is the dedicated AI engine. It is responsible for loading and running machine learning models (like DeepSeek via `mlx-swift` or built-in Apple models) to perform analysis tasks such as summarization and embedding generation. *This component is stubbed and ready for the implementation of the core AI logic.*
*   `SearchIndexManager.swift`: This manager powers all search functionality. It builds and maintains a robust, keyword-based inverted index for fast and efficient text search. It is designed to be extended with a vector-based index to enable powerful semantic search capabilities, which will be driven by the embeddings generated by `MLXManager`.
*   `EncryptionManager.swift`: A lightweight manager responsible for securing sensitive data. It provides straightforward methods to encrypt and decrypt the `content` field of a `ContentEntity` using a master key securely stored in the device's keychain.

### State Management

*   `AppState.swift`: This is a global, observable object that creates and holds instances of the core managers (`DataFlowManager`, `SearchIndexManager`, etc.). It is injected into the SwiftUI view hierarchy as an `EnvironmentObject`, providing all views with a single, reliable point of access to the application's backend services.

### Data Model

*   `ContentEntity` (Core Data NSManagedObject): This is the universal data container for all information stored in the app. Its flexible attribute set is designed to hold not only the original content but also all the metadata generated by the AI processing pipeline (summaries, keywords, embeddings, etc.).

### Views

*   `ContentView.swift`: The root view of the application, which sets up the main `TabView`.
*   `HomeView.swift`: The main dashboard, providing an overview and quick actions.
*   `CaptureView.swift`: A simplified view for adding new text-based content to the application. It directly uses the `DataFlowManager` to save new entries.
*   `SearchView.swift`: A clean and simple interface for performing keyword searches across all content.
*   `SettingsView.swift`: A view for displaying application settings and status.

## Development Status
The project has undergone a significant and complete refactoring to resolve critical build failures. The codebase is now stable, buildable, and architecturally sound.

**Current Status:** **Stable and Buildable.**

**Next Steps:** The immediate next step is to begin implementing the core AI logic within `MLXManager` and wire it into the `DataFlowManager` to begin processing content automatically when it's created. 